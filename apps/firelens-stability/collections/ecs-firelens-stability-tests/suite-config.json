{
    "definitions": {
        "collectionUniqueName": "{{managed.executionName}}-{{managed.executionId}}-{{managed.collectionName}}",
        "testId": "{{managed.suiteName}}-{{managed.caseName}}",
        "segfault": false,
        "clusterName": "{{managed.executionName}}-{{managed.executionId}}-{{managed.collectionName}}"
    },
    "config": {
        "cluster": "{{definitions.collectionUniqueName}}",
        "template": "golden-path-mountebank-fargate-v01-11-2023"{{#if definitions.enableMonitoring}},
        "dashboard": "{{definitions.collectionUniqueName}}",
        "lists.dashboardWidgets": [
            {
                "name": "{{config.collectionUniqueName}}",
                "section": "0_{{config.collectionUniqueName}}",
                "config": {
                    "type": "text",
                    "x": 0,
                    "y": 0,
                    "width": 24,
                    "height": 6,
                    "properties": {
                        "markdown": "# Stability Test {{managed.executionName}}-{{managed.executionId}} \nThis dashboard is autogenerated by the FireLens stability test framework.\n## Test details\n**Cluster**: {{definitions.clusterName}}\n\n**Dashboard**: A link to this dashboard: [{{definitions.collectionUniqueName}}](#dashboards:name={{definitions.collectionUniqueName}}). \n "
                    }
                }
            },
            {
                "name": "{{config.collectionUniqueName}}",
                "section": "1_{{managed.suiteName}}",
                "config": {
                    "type": "text",
                    "x": 0,
                    "y": 0,
                    "width": 24,
                    "height": 1,
                    "properties": {
                        "markdown": "## {{managed.suiteName}} Test Suite"
                    }
                }
            },
            {
                "name": "{{managed.suiteName}}/DiskUtilization",
                "section": "1_{{managed.suiteName}}",
                "config": {
                    "type": "metric",
                    "properties": {
                        "view": "timeSeries",
                        "stacked": false,
                        "metrics": [
                            {{#each2 managed.suiteCaseNamesUnique}}
                            [ "ECS/ContainerInsights", "EphemeralStorageUtilized", "TaskDefinitionFamily", "{{_item}}", "ClusterName", "{{definitions.clusterName}}", { "region": "{{config.region}}" } ]{{#unless _isLast}},{{/unless}}
                            {{/each2}}
                        ],
                        "region": "{{config.region}}",
                        "title": "{{managed.suiteName}}/DiskUtilization",
                        "period": 300
                    }
                }
            },
            {
                "name": "{{managed.suiteName}}/MemoryUtilization",
                "section": "1_{{managed.suiteName}}",
                "config": {
                    "type": "metric",
                    "properties": {
                        "view": "timeSeries",
                        "stacked": false,
                        "metrics": [
                            {{#each2 managed.suiteCaseNamesUnique}}
                            [ "ECS/ContainerInsights", "MemoryUtilized", "TaskDefinitionFamily", "{{_item}}", "ClusterName", "{{definitions.clusterName}}", { "region": "{{config.region}}" } ]{{#unless _isLast}},{{/unless}}
                            {{/each2}}
                        ],
                        "region": "{{config.region}}",
                        "title": "{{managed.suiteName}}/MemoryUtilization",
                        "period": 300
                    }
                }
            },
            {
                "name": "{{managed.suiteName}}/MemoryUtilization",
                "section": "1_{{managed.suiteName}}",
                "config": {
                    "type": "metric",
                    "properties": {
                        "view": "timeSeries",
                        "stacked": false,
                        "metrics": [
                            {{#each2 managed.suiteCaseNamesUnique}}
                            [ "ECS/ContainerInsights", "MemoryUtilized", "TaskDefinitionFamily", "{{_item}}", "ClusterName", "{{definitions.clusterName}}", { "region": "{{config.region}}" } ]{{#unless _isLast}},{{/unless}}
                            {{/each2}}
                        ],
                        "region": "{{config.region}}",
                        "title": "{{managed.suiteName}}/MemoryUtilization",
                        "period": 300
                    }
                }
            },
            {
                "name": "{{managed.suiteName}}/CpuUtilization",
                "section": "1_{{managed.suiteName}}",
                "config": {
                    "type": "metric",
                    "properties": {
                        "view": "timeSeries",
                        "stacked": false,
                        "metrics": [
                            {{#each2 managed.suiteCaseNamesUnique}}
                            [ "ECS/ContainerInsights", "CpuUtilized", "TaskDefinitionFamily", "{{_item}}", "ClusterName", "{{definitions.clusterName}}", { "region": "{{config.region}}" } ]{{#unless _isLast}},{{/unless}}
                            {{/each2}}
                        ],
                        "region": "{{config.region}}",
                        "title": "{{managed.suiteName}}/CpuUtilization",
                        "period": 300
                    }
                }
            }
        ],
        "lists.metricAlarms": [
            {
                "name": "{{definitions.clusterName}}/{{managed.caseNameUnique}}/DiskAlarm",
                "config": {
                    "AlarmName": "{{definitions.clusterName}}/{{managed.caseNameUnique}}/DiskAlarm",
                    "ActionsEnabled": true,
                    "OKActions": [],
                    "AlarmActions": [],
                    "InsufficientDataActions": [],
                    "MetricName": "EphemeralStorageUtilized",
                    "Namespace": "ECS/ContainerInsights",
                    "Statistic": "Average",
                    "Dimensions": [
                        {
                            "Name": "TaskDefinitionFamily",
                            "Value": "{{managed.caseNameUnique}}"
                        },
                        {
                            "Name": "ClusterName",
                            "Value": "{{managed.caseNameUnique}}"
                        }
                    ],
                    "Period": 300,
                    "EvaluationPeriods": 1,
                    "DatapointsToAlarm": 1,
                    "Threshold": 10,
                    "ComparisonOperator": "GreaterThanThreshold",
                    "TreatMissingData": "missing"
                }
            }
        ]
        {{/if}}
    }
}